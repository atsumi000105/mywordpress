!function(t){var e={};function o(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=o(1),a=new(o(3).WP2StaticProcessExports);e.WP2StaticAJAX=class{doAJAXExport(t,e,o,r,i,s){let l=t[0],c=l;c=void 0!==e[l]?e[l]:l,n.default("#current_action").html(c),n.default(".hiddenActionField").val("wp_static_html_output_ajax"),n.default("#hiddenAJAXAction").val(l);const d=n.default(".options-form :input").filter((t,e)=>""!==n.default(e).val()).serialize();n.default.ajax({data:d,dataType:"html",error:this.ajaxErrorHandler,method:"POST",success(n){"SUCCESS"===n&&t.length>1?(t.shift(),this.doAJAXExport(t,e,o,r,s)):n>0?this.doAJAXExport(t,e,o,r,s):"SUCCESS"===n?a.processExportTargets(e,o,r,i,s):this.ajaxErrorHandler()},url:ajaxurl})}ajaxErrorHandler(){const t='Failed during "'+this.statusText+'", <button id="downloadExportLogButton">Download export log</button>';n.default("#current_action").html(t),n.default(".pulsate-css").hide(),n.default("#startExportButton").prop("disabled",!1),n.default(".saveSettingsButton").prop("disabled",!1),n.default(".resetDefaultSettingsButton").prop("disabled",!1),n.default(".cancelExportButton").hide()}}},function(t,e){t.exports=jQuery},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=new(o(0).WP2StaticAJAX),a=[{description:"Basin does stuff",id:"basin",name:"Basin",placeholder:"https://usebasin.com/f/",website:"https://usebasin.com"},{description:"FormSpree is very simple to start with, just set your\n endpoint, including your email address and start sending.",id:"formspree",name:"Formspree",placeholder:"https://formspree.io/myemail@domain.com",website:"https://formspree.io"},{description:"Zapier does stuff",id:"zapier",name:"Zapier",placeholder:"https://hooks.zapier.com/hooks/catch/4977245/jqj3l4/",website:"https://zapier.com"},{description:"Formkeep does stuff",id:"formkeep",name:"FormKeep",placeholder:"https://formkeep.com/f/5dd8de73ce2c",website:"https://formkeep.com"},{description:"Use any custom endpoint",id:"custom",name:"Custom endpoint",placeholder:"https://mycustomendpoint.com/SOMEPATH",website:"https://docs.wp2static.com"}];let r="";const i={folder:{exportSteps:["finalize_deployment"],requiredFields:{}},zip:{exportSteps:["finalize_deployment"],requiredFields:{}}};let s;const l=JSON.parse(wp2staticString.siteInfo);let c;c=wp2staticString.currentDeploymentMethod?wp2staticString.currentDeploymentMethod:"folder";const d=l.uploads_url+"wp2static-working-files/EXPORT-LOG.txt",p="";let u=[],h=0,f="";const g=/^(?:\w+:)?\/\/(\S+)$/,m=/^localhost[:?\d]*(?:[^:?\d]\S*)?$/,_=/^[^\s.]+\.\S{2,}$/;let w=0;const b={crawl_site:"Crawling initial file list",post_export_teardown:"Cleaning up after processing",post_process_archive_dir:"Processing the crawled files"};jQuery(t=>{function e(e){e?(t("#initial_crawl_list_loader").hide(),t("#initial_crawl_list_count").text(`${e} URLs were\n detected on your site that will be used to initiate the crawl.\n Other URLs will be discovered while crawling.`),t("#preview_initial_crawl_list_button").show(),t("#startExportButton").prop("disabled",!1),t(".saveSettingsButton").prop("disabled",!1),t(".resetDefaultSettingsButton").prop("disabled",!1),t("#current_action").html(`${e} URLs were detected for\n initial crawl list. <a href="#" id="GoToDetectionTabButton">Adjust detection\n via the URL Detection tab.</a>`),t(".pulsate-css").hide()):(t("#current_action").html('Failed to generate initial file list.\n Please <a href="https://docs.wp2static.com" target="_blank">contact support</a>'),t(".pulsate-css").hide())}function o(e){t("#current_action").html("Failed to generate Initial Crawl List.\n Please check your permissions to the WordPress upload directory or check your\n Export Log in case of more info."),t(".pulsate-css").hide(),t("#startExportButton").prop("disabled",!0),t(".saveSettingsButton").prop("disabled",!1),t(".resetDefaultSettingsButton").prop("disabled",!1),t(".cancelExportButton").hide(),t("#initial_crawl_list_loader").hide()}function v(e,o,n){t(".hiddenActionField").val("wp_static_html_output_ajax"),t("#hiddenAJAXAction").val(e),t("#progress").show(),t(".pulsate-css").show();const a=t(".options-form :input").filter((e,o)=>""!==t(o).val()).serialize();t.ajax({data:a,dataType:"html",error:n,method:"POST",success:o,url:ajaxurl})}function x(e){t("#progress").hide(),location.reload()}function y(e){t("#progress").hide(),location.reload()}function S(){t("#current_action").html("Saving options"),v("save_options",x,y)}function k(e){e?(t("#current_action").html(`Download <a href="${e}">\n ${e}/a>`),t(".pulsate-css").hide()):(t("#current_action").html('Failed to download Export Log\n <a id="downloadExportLogButton" href="#">try again</a>'),t(".pulsate-css").hide())}function E(e){t(".pulsate-css").hide(),t("#current_action").html('Failed to download Export Log\n <a id="downloadExportLogButton" href="#">try again</a>')}function B(e){e?(t("#current_action").html("Crawl Cache successfully deleted."),t(".pulsate-css").hide()):(t(".pulsate-css").hide(),t("#current_action").html("Failed to delete Crawl Cache."))}function D(e){t(".pulsate-css").hide(),t("#current_action").html("Failed to delete Crawl Cache.")}function T(){window.clearInterval(w);const e='Failed during "'+f+'", <button id="downloadExportLogButton">Download export log</button>';t("#current_action").html(e),t(".pulsate-css").hide(),t("#startExportButton").prop("disabled",!1),t(".saveSettingsButton").prop("disabled",!1),t(".resetDefaultSettingsButton").prop("disabled",!1),t(".cancelExportButton").hide()}function P(t){n.doAJAXExport(["crawl_site","post_process_archive_dir"],b,u,i,c,l)}function A(){const e=+new Date-h;t("#export_timer").html("<b>Export duration: </b>"+function(t){const e=Math.floor(t/6e4),o=parseFloat((t%6e4/1e3).toFixed(0));return e+":"+(o<10?"0":"")+o}(e))}function j(){if(h=+new Date,w=window.setInterval(A,1e3),""!==(r=function(){t("#targetFolder").is(":visible")&&""===t("#targetFolder").val()&&(r+="Target folder may not be empty. Please adjust your settings.");void 0!==t("#baseUrl").val()&&""!==t("#baseUrl").val()||t("#allowOfflineUsage").is(":checked")||(r+="Please set the Base URL field to the address you will host your static site.\n");(function(t){if("string"!=typeof t)return!1;const e=t.match(g);if(!e)return!1;const o=e[1];if(!o)return!1;if(m.test(o)||_.test(o))return!0;return!1})(t("#baseUrl").val())||t("#allowOfflineUsage").is(":checked")||"/"!==t("#baseUrl").val()&&(r+="Please set the Base URL field to a valid URL, ie http://mystaticsite.com.\n");const e=i[c].requiredFields;e&&function(e){Object.keys(e).forEach((o,n)=>{""===t("#"+o).val()&&(r+=e[o]+"\n")})}(e);const o=i[c].repoField;o&&function(e){const o=String(t("#"+e.field).val());""!==o&&2!==o.split("/").length&&(r+=e.message)}(o);return r}()))return alert(r),t("#progress").hide(),t("#startExportButton").prop("disabled",!1),t(".saveSettingsButton").prop("disabled",!1),t(".resetDefaultSettingsButton").prop("disabled",!1),t(".cancelExportButton").hide(),!1;t("#current_action").html("Starting export..."),u=[],"zip"===c&&t("#createZip").attr("checked","checked"),u.push(c),v("prepare_for_export",P,T)}function L(){t("#downloadZIP").hide(),t("#goToMyStaticSite").hide(),t("#exportDuration").hide()}function O(e){if(e in a){const e=a[p];t("#form_processor_description").text(e.description);const o=e.website,n=document.createElement("a");n.setAttribute("href",o),n.innerHTML="Visit "+e.name,t("#form_processor_website").html(n),t("#form_processor_endpoint").attr("placeholder",e.placeholder)}else t("#form_processor_description").text(""),t("#form_processor_website").html(""),t("#form_processor_endpoint").attr("placeholder","Form endpoint")}function U(e){t("#downloadZIP").hide(),c=e,t(".selected_deployment_method").val(e)}function C(e){t(e).is(":checked")?t("#baseUrl-zip").prop("disabled",!0):t("#baseUrl-zip").prop("disabled",!1)}function F(e){t('[class$="_settings_block"]').hide(),t("."+e+"_settings_block").show()}function R(e){const o={add_ons:"Add-ons",advanced_settings:"Advanced Options",automation_settings:"Automation",caching_settings:"Caching",crawl_settings:"Crawling",export_logs:"Logs",form_settings:"Forms",help_troubleshooting:"Help",processing_settings:"Processing",production_deploy:"Production",staging_deploy:"Staging",url_detection:"URL Detection",workflow_tab:"Workflow"};t.each(t(".nav-tab"),(o,n)=>{t(n).text()===e?(t(n).addClass("nav-tab-active"),t(n).blur()):t(n).removeClass("nav-tab-active")});for(const n in o)o.hasOwnProperty(n)&&(o[n]===e?(t("."+n).show(),t("html, body").scrollTop(0)):t("."+n).hide())}function q(t){alert("Successful support request sent")}function z(t){alert("Failed to send support request. Please try again or contact help@wp2static.com.")}function M(t){alert("Settings have been reset to default, the page will now be reloaded."),window.location.reload(!0)}function I(t){alert("Error encountered in trying to reset settings. Please try refreshing the page.")}function X(e){"SUCCESS"===e?alert("Deploy cache cleared"):alert("FAIL: Unable to delete deploy cache"),s.hide(),t(".pulsate-css").hide()}function J(e){alert("FAIL: Unable to delete deploy cache"),s.hide(),t(".pulsate-css").hide()}function $(e){"SUCCESS"===e?alert("Connection/Upload Test Successful"):alert("FAIL: Unable to complete test upload to "+c),s.hide(),t(".pulsate-css").hide()}function G(e){alert("FAIL: Unable to complete test upload to "+c),s.hide(),t(".pulsate-css").hide()}t(document).on("click","#detectEverythingButton",e=>{e.preventDefault(),t('#detectionOptionsTable input[type="checkbox"]').attr("checked",1)}),t(document).on("click","#deleteCrawlCache",e=>{e.preventDefault(),t("#current_action").html("Deleting Crawl Cache..."),v("delete_crawl_cache",B,D)}),t(document).on("click","#detectNothingButton",e=>{e.preventDefault(),t('#detectionOptionsTable input[type="checkbox"]').attr("checked",0)}),t(document).on("click","#downloadExportLogButton",e=>{e.preventDefault(),t("#current_action").html("Downloading Export Log..."),v("download_export_log",k,E)}),"granted"!==Notification.permission&&"https:"===window.location.protocol&&Notification.requestPermission(),t('input[type="checkbox"]').change(()=>{!function(e){const o=t(e).attr("name").replace("sendVia","").toLowerCase(),n=t("."+o);t(e).is(":checked")?n.show():n.hide()}(this)}),t("#allowOfflineUsage").change(()=>{C(t(this))}),t("#form_processor_select").change(t=>{O(t.currentTarget.value)}),t(".selected_deployment_method").change(t=>{F(t.currentTarget.value),U(t.currentTarget.value),L()}),t("#reload_log_button").click(()=>{t("#log_load_progress").show(),t("#export_log_textarea").attr("disabled",1),t("#export_log_textarea").html("Loading log file..."),t.get(d+"?cacheBuster="+Date.now(),e=>{t("#log_load_progress").hide(),t("#export_log_textarea").attr("disabled",0),t("#export_log_textarea").html(e)}).fail(()=>{t("#log_load_progress").hide(),t("#export_log_textarea").attr("disabled",0),t("#export_log_textarea").html("Requested log file not found")})}),t(document).on("click","#GoToDetectionTabButton",t=>{t.preventDefault(),R("URL Detection")}),t(document).on("click","#GoToDeployTabButton,#GoToDeployTabLink",t=>{t.preventDefault(),R("Deployment")}),t(document).on("click","#GoToAdvancedTabButton",t=>{t.preventDefault(),R("Advanced Options")}),t(document).on("click",".nav-tab",e=>{e.preventDefault(),R(t(e.currentTarget).text())}),t(document).on("submit","#general-options",t=>{t.preventDefault()}),t(document).on("click","#send_supportRequest",e=>{e.preventDefault();let o=t("#supportRequestContent").val();t("#supportRequestIncludeLog").is(":checked")&&t.get(d,e=>{o+="#### EXPORT LOG ###",o+=e,e={email:t("#supportRequestEmail").val(),supportRequest:o},t.ajax({data:e,dataType:"html",error:z,method:"POST",success:q,url:"https://hooks.zapier.com/hooks/catch/4977245/jqj3l4/"})});const n={email:t("#supportRequestEmail").val(),supportRequest:o};t.ajax({data:n,dataType:"html",error:z,method:"POST",success:q,url:"https://hooks.zapier.com/hooks/catch/4977245/jqj3l4/"})}),t("#startExportButton").click(()=>{L(),t(this).prop("disabled",!0),t(".saveSettingsButton").prop("disabled",!0),t(".resetDefaultSettingsButton").prop("disabled",!0),t(".cancelExportButton").show(),j()}),t(".cancelExportButton").click(()=>{confirm("Stop current export and reload page?")&&(window.location.href=window.location.href)}),t("#wp2static-footer").on("click",".resetDefaultSettingsButton",t=>{t.preventDefault(),v("reset_default_settings",M,I)}),t("#wp2static-footer").on("click",".saveSettingsButton",t=>{t.preventDefault(),S()}),t(".wrap").on("click","#delete_deploy_cache_button",e=>{e.preventDefault();const o=e.currentTarget;(s=t(o).siblings("div.spinner")).show(),v("delete_deploy_cache",X,J)}),t(".wrap").on("click",'[id$="-test-button"]',e=>{e.preventDefault(),(s=t("button").siblings("div.spinner")).show(),v("test_"+c,$,G)}),t(".wrap").on("click","#save-and-reload",t=>{t.preventDefault(),S()}),t(".spinner").hide(),void 0===t("#baseUrl-"+c).val()&&(c="folder"),function(e){e.forEach(e=>{const o=t("<option>").val(e.id).text(e.name);t("#form_processor_select").append(o)})}(a),O(p),C(t("#allowOfflineUsage")),F(c),U(c),function(){const e=t(".update-nag, .updated, .error, .is-dismissible, .elementor-message");t.each(e,(e,o)=>{t(o).hasClass("wp2static-notice")||t(o).hide()})}(),f="Analyzing site... this may take a few minutes (but it's worth it!)",t("#current_action").html(f),v("generate_filelist_preview",e,o)})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=o(1),a=new(o(0).WP2StaticAJAX);e.WP2StaticProcessExports=class{processExportTargets(t,e,o,r,i){if(e.length>0){const n=o[e.shift()].exportSteps;a.doAJAXExport(n,t,e,o,r,i)}else{if("zip"===r){const t=i.uploads_url+"wp2static-exported-site.zip?cacheBuster="+Date.now();n.default("#downloadZIP").attr("href",t),n.default("#downloadZIP").show()}else{const t=String(n.default("#baseUrl").val());n.default("#goToMyStaticSite").attr("href",t),n.default("#goToMyStaticSite").show()}n.default("#goToMyStaticSite").focus(),n.default(".pulsate-css").hide(),n.default("#startExportButton").prop("disabled",!1),n.default(".saveSettingsButton").prop("disabled",!1),n.default(".resetDefaultSettingsButton").prop("disabled",!1),n.default(".cancelExportButton").hide()}}}}]);
//# sourceMappingURL=wp2static-admin.js.map